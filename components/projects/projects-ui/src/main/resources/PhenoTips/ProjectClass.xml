<?xml version="1.0" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see http://www.gnu.org/licenses/
-->

<xwikidoc>
	<web>PhenoTips</web>
	<name>ProjectClass</name>
	<language />
	<defaultLanguage />
	<translation>0</translation>
    <parent>PhenoTips.WebHome</parent>
	<creator>xwiki:XWiki.Admin</creator>
	<author>xwiki:XWiki.Admin</author>
	<customClass />
	<contentAuthor>xwiki:XWiki.Admin</contentAuthor>
	<creationDate>1441040721000</creationDate>
    <parent>PhenoTips.WebHome</parent>
    <date>1441139224000</date>
	<contentUpdateDate>1441051803000</contentUpdateDate>
	<version>1.1</version>
	<title />
	<defaultTemplate />
	<validationScript />
	<comment />
	<minorEdit>false</minorEdit>
	<syntaxId>xwiki/2.1</syntaxId>
	<hidden>false</hidden>
	<object>
		<class>
			<name>XWiki.ConfigurableClass</name>
			<customClass />
			<customMapping />
			<defaultViewSheet />
			<defaultEditSheet />
			<defaultWeb />
			<nameField />
			<validationScript />
			<advancedOnly>
				<customDisplay />
				<defaultValue />
				<disabled>0</disabled>
				<displayFormType>select</displayFormType>
				<displayType />
				<name>advancedOnly</name>
				<number>5</number>
				<prettyName>advancedOnly</prettyName>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
			</advancedOnly>
			<categoryPriority>
				<customDisplay />
				<disabled>0</disabled>
				<name>categoryPriority</name>
				<number>2</number>
				<numberType>integer</numberType>
				<prettyName>categoryPriority</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.NumberClass</classType>
			</categoryPriority>
			<codeToExecute>
				<customDisplay />
				<disabled>0</disabled>
				<editor>---</editor>
				<name>codeToExecute</name>
				<number>11</number>
				<picker>0</picker>
				<prettyName>codeToExecute</prettyName>
				<rows>5</rows>
				<size>40</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
			</codeToExecute>
			<configurationClass>
				<customDisplay />
				<disabled>0</disabled>
				<name>configurationClass</name>
				<number>7</number>
				<picker>0</picker>
				<prettyName>configurationClass</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</configurationClass>
			<configureGlobally>
				<customDisplay />
				<defaultValue />
				<disabled>0</disabled>
				<displayFormType>checkbox</displayFormType>
				<displayType />
				<name>configureGlobally</name>
				<number>8</number>
				<prettyName>configureGlobally</prettyName>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
			</configureGlobally>
			<displayInCategory>
				<customDisplay />
				<disabled>0</disabled>
				<name>displayInCategory</name>
				<number>1</number>
				<picker>0</picker>
				<prettyName>displayInCategory</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</displayInCategory>
			<displayInSection>
				<customDisplay />
				<disabled>0</disabled>
				<name>displayInSection</name>
				<number>3</number>
				<picker>0</picker>
				<prettyName>displayInSection</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</displayInSection>
			<heading>
				<customDisplay />
				<disabled>0</disabled>
				<name>heading</name>
				<number>6</number>
				<picker>0</picker>
				<prettyName>heading</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</heading>
			<iconAttachment>
				<customDisplay />
				<disabled>0</disabled>
				<name>iconAttachment</name>
				<number>12</number>
				<picker>0</picker>
				<prettyName>iconAttachment</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</iconAttachment>
			<linkPrefix>
				<customDisplay />
				<disabled>0</disabled>
				<name>linkPrefix</name>
				<number>9</number>
				<picker>0</picker>
				<prettyName>linkPrefix</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</linkPrefix>
			<propertiesToShow>
				<cache>0</cache>
				<customDisplay />
				<disabled>0</disabled>
				<displayType>input</displayType>
				<multiSelect>1</multiSelect>
				<name>propertiesToShow</name>
				<number>10</number>
				<picker>0</picker>
				<prettyName>propertiesToShow</prettyName>
				<relationalStorage>1</relationalStorage>
				<separator>
				</separator>
				<separators> ,|</separators>
				<size>20</size>
				<sort>none</sort>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<values />
				<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
			</propertiesToShow>
			<sectionPriority>
				<customDisplay />
				<disabled>0</disabled>
				<name>sectionPriority</name>
				<number>4</number>
				<numberType>integer</numberType>
				<prettyName>sectionPriority</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<validationMessage />
				<validationRegExp />
				<classType>com.xpn.xwiki.objects.classes.NumberClass</classType>
			</sectionPriority>
		</class>
		<name>PhenoTips.ProjectClass</name>
		<number>0</number>
		<className>XWiki.ConfigurableClass</className>
		<guid>b846b4af-ac79-4370-89bf-fa2bbcf11efc</guid>
		<property>
			<advancedOnly />
		</property>
		<property>
			<categoryPriority>0</categoryPriority>
		</property>
		<property>
			<codeToExecute>
#set ($projectClassName = 'PhenoTips.ProjectClass')
#set ($projectTemplateName = 'PhenoTips.ProjectTemplate')
#set ($projectsHome = 'Projects.WebHome')

{{html}}
&lt;form id="project-creation-form" class="xformInline" action="$doc.getURL($xcontext.action, $request.queryString)" method="post"&gt;
  &lt;div&gt;
    &lt;input type="hidden" name="form_token" value="$!{services.csrf.getToken()}" /&gt;
    &lt;input type="hidden" name="doCreate" value="1" /&gt;
    &lt;input type="hidden" name="classTemplate" value="$projectTemplateName" /&gt;
    &lt;input type="hidden" name="space" value="$xwiki.getDocument(${projectsHome}).space" /&gt;
    &lt;input type="hidden" name="parent" value="${projectsHome}" /&gt;
    &lt;label&gt;
      &lt;span class="fa fa-plus-circle"&gt;&lt;/span&gt;
      $services.localization.render('phenotips.projectClass.newProject.label')
      &lt;input type="text" name="name" placeholder="$services.localization.render('phenotips.projectClass.newProject.placeHolder')" value="" size="30"/&gt;
    &lt;/label&gt;
    &lt;input type="submit" class="button" value="$services.localization.render('phenotips.projectClass.newProject.submit')"/&gt;
  &lt;/div&gt;
&lt;/form&gt;
{{/html}}

{{include reference="Projects.WebHome" /}}
			</codeToExecute>
		</property>
		<property>
			<configurationClass />
		</property>
		<property>
			<configureGlobally>1</configureGlobally>
		</property>
		<property>
			<displayInCategory>phenotips</displayInCategory>
		</property>
		<property>
			<displayInSection>Projects</displayInSection>
		</property>
		<property>
			<heading />
		</property>
		<property>
			<iconAttachment />
		</property>
		<property>
			<linkPrefix />
		</property>
		<property>
			<propertiesToShow />
		</property>
		<property>
			<sectionPriority>450</sectionPriority>
		</property>
	</object>
	<object>
		<class>
			<name>XWiki.WikiMacroClass</name>
			<customClass />
			<customMapping />
			<defaultViewSheet />
			<defaultEditSheet />
			<defaultWeb />
			<nameField />
			<validationScript />
			<code>
				<disabled>0</disabled>
				<name>code</name>
				<number>9</number>
				<prettyName>Macro code</prettyName>
				<rows>20</rows>
				<size>40</size>
				<unmodifiable>0</unmodifiable>
				<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
			</code>
			<contentDescription>
				<disabled>0</disabled>
				<name>contentDescription</name>
				<number>8</number>
				<prettyName>Content description (Not applicable for "No content"
					type)</prettyName>
				<rows>5</rows>
				<size>40</size>
				<unmodifiable>0</unmodifiable>
				<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
			</contentDescription>
			<contentType>
				<cache>0</cache>
				<disabled>0</disabled>
				<displayType>select</displayType>
				<multiSelect>0</multiSelect>
				<name>contentType</name>
				<number>7</number>
				<prettyName>Macro content type</prettyName>
				<relationalStorage>0</relationalStorage>
				<separator>|</separator>
				<separators>|</separators>
				<size>1</size>
				<unmodifiable>0</unmodifiable>
				<values>Optional|Mandatory|No content</values>
				<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
			</contentType>
			<defaultCategory>
				<disabled>0</disabled>
				<name>defaultCategory</name>
				<number>4</number>
				<prettyName>Default category</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</defaultCategory>
			<description>
				<disabled>0</disabled>
				<name>description</name>
				<number>3</number>
				<prettyName>Macro description</prettyName>
				<rows>5</rows>
				<size>40</size>
				<unmodifiable>0</unmodifiable>
				<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
			</description>
			<id>
				<disabled>0</disabled>
				<name>id</name>
				<number>1</number>
				<prettyName>Macro id</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</id>
			<name>
				<disabled>0</disabled>
				<name>name</name>
				<number>2</number>
				<prettyName>Macro name</prettyName>
				<size>30</size>
				<unmodifiable>0</unmodifiable>
				<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
			</name>
			<supportsInlineMode>
				<disabled>0</disabled>
				<displayFormType>select</displayFormType>
				<displayType>yesno</displayType>
				<name>supportsInlineMode</name>
				<number>5</number>
				<prettyName>Supports inline mode</prettyName>
				<unmodifiable>0</unmodifiable>
				<classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
			</supportsInlineMode>
			<visibility>
				<cache>0</cache>
				<disabled>0</disabled>
				<displayType>select</displayType>
				<multiSelect>0</multiSelect>
				<name>visibility</name>
				<number>6</number>
				<prettyName>Macro visibility</prettyName>
				<relationalStorage>0</relationalStorage>
				<separator>|</separator>
				<separators>|</separators>
				<size>1</size>
				<unmodifiable>0</unmodifiable>
				<values>Current User|Current Wiki|Global</values>
				<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
			</visibility>
		</class>
		<name>PhenoTips.ProjectClass</name>
		<number>0</number>
		<className>XWiki.WikiMacroClass</className>
		<guid>cffc0f66-cfd7-45b4-9844-7a2e70ea9e86</guid>
		<property>
			<code>{{velocity}}
#set ($projectClassName = 'PhenoTips.ProjectClass')
#set ($projectTemplateName = 'PhenoTips.ProjectTemplate')
##
#set ($query = $services.query.xwql("from doc.object(${projectClassName}) as std where doc.fullName&lt;&gt;:template").bindValue('template', $projectTemplateName ))
#set ($projectDocs = $xwiki.wrapDocs($query.execute()))
#set ($projectData = [])
##
#foreach ($projectDoc in $projectDocs)
  #set ($projectObj = $projectDoc.getObject($projectClassName))
  #set ($discard = $projectData.add({
    'doc' : $projectDoc ,
    'obj' : $projectObj ,
    'doc.fullName' : $projectDoc.fullName,
    'name' : $projectDoc.title
  }))
#end
##
(% id="project-directory" %)
#if ($projectData.size() == 0)
  {{info}}$services.localization.render('phenotips.projectClass.noneDefined')
    #if($hasAdmin &amp;&amp; $doc.documentReference.name != 'XWikiPreferences')
      [[$services.localization.render('phenotips.projectClass.manage')>>path:${xwiki.getDocument('XWiki.XWikiPreferences').getURL('admin','editor=globaladmin&amp;section=studies')}]]
    #end
  {{/info}}
#else
  #foreach ($projectDatum in $Data)
    $foreach.index
  #end
#end
{{/velocity}}
			</code>
		</property>
		<property>
			<contentDescription />
		</property>
		<property>
			<contentType>Optional</contentType>
		</property>
		<property>
			<defaultCategory />
		</property>
		<property>
			<description />
		</property>
		<property>
			<id>phenotips-projects</id>
		</property>
		<property>
			<name>PhenoTips projects list</name>
		</property>
		<property>
			<supportsInlineMode>0</supportsInlineMode>
		</property>
		<property>
			<visibility>Current Wiki</visibility>
		</property>
	</object>
	<content />
	<renderedcontent />
</xwikidoc>